Object.defineProperty(exports,"__esModule",{value:!0});var slice=require("./slice-f520d051.js"),React=require("react");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("react-dom");var React__default=_interopDefaultLegacy(React),useIsomorphicLayoutEffect="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function is(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function shallowEqual(e,t){if(is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var u=0;u<r.length;u++)if(!Object.prototype.hasOwnProperty.call(t,r[u])||!is(e[r[u]],t[r[u]]))return!1;return!0}function useReduxContext(){var e=React.useContext(slice.ReactReduxContext);if("production"!==process.env.NODE_ENV&&!e)throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>");return e}function createStoreHook(e){var t=(e=void 0===e?slice.ReactReduxContext:e)===slice.ReactReduxContext?useReduxContext:function(){return React.useContext(e)};return function(){return t().store}}var useStore=createStoreHook();function createDispatchHook(e){var t=(e=void 0===e?slice.ReactReduxContext:e)===slice.ReactReduxContext?useStore:createStoreHook(e);return function(){return t().dispatch}}var useDispatch=createDispatchHook(),refEquality=function(e,t){return e===t};function useSelectorWithStoreAndSubscription(e,t,r,n){var u,a=React.useReducer(function(e){return e+1},0)[1],o=React.useMemo(function(){return new slice.Subscription(r,n)},[r,n]),c=React.useRef(),i=React.useRef(),l=React.useRef(),s=React.useRef(),d=r.getState();try{u=e!==i.current||d!==l.current||c.current?e(d):s.current}catch(e){throw c.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),e}return useIsomorphicLayoutEffect(function(){i.current=e,l.current=d,s.current=u,c.current=void 0}),useIsomorphicLayoutEffect(function(){function e(){try{var e=i.current(r.getState());if(t(e,s.current))return;s.current=e}catch(e){c.current=e}a()}return o.onStateChange=e,o.trySubscribe(),e(),function(){return o.tryUnsubscribe()}},[r,o]),u}function createSelectorHook(e){var n=(e=void 0===e?slice.ReactReduxContext:e)===slice.ReactReduxContext?useReduxContext:function(){return React.useContext(e)};return function(e,t){if(void 0===t&&(t=refEquality),"production"!==process.env.NODE_ENV&&!e)throw new Error("You must pass a selector to useSelector");var r=n(),r=useSelectorWithStoreAndSubscription(e,t,r.store,r.subscription);return React.useDebugValue(r),r}}var useSelector=createSelectorHook(),_require=require("react-redux"),useStore$1=_require.useStore,_require2=require("../Provider/slice"),_updateValue=_require2.updateValue,_updateField=_require2.updateField,_updateFieldProps=_require2.updateFieldProps,_setError=_require2.setError,_clearError=_require2.clearError,_toggleValidation=_require2.toggleValidation,useFieldEvent=function(s){var d=useStore$1();return React.useCallback(function(e){var t,n=d.getState(),u=d.dispatch,e=(null===(t=n.fields[s])||void 0===t?void 0:t.subscribers)&&(null===(t=n.fields[s])||void 0===t?void 0:t.subscribers[e]),a=n.data,o=n.fields,c=n.meta,i=a[s],l=o[s];null!=e&&e.forEach(function(r){var e=a[r.subscriber],t=o[r.subscriber];r.callback({name:r.name,formMetaData:c,store:d,state:n,dispatch:u,data:a,fields:o,ownName:s,ownValue:e,ownField:t,subValue:i,subField:l,subName:r.subscriber,staticArgs:r.args,updateValue:function(e){return u(_updateValue({name:s,value:e}))},updateField:function(e){return u(_updateField({name:s,update:e}))},updateFieldProps:function(e){return u(_updateFieldProps({name:s,update:e}))},setError:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.name;return u(_setError({name:s,error:t,message:e}))},clearError:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.name;return u(_clearError({name:s,error:e}))},toggleValidation:function(e,t){return u(_toggleValidation({name:s,validation:null!=e?e:r.name,enabled:t}))}})})},[s,d])},ON_UPDATE="onUpdate",ON_CHANGE="onChange",ON_BLUR="onBlur",ON_LOAD="onLoad",Field=function(e){var v=e.component,m=e.name;return function(){var e=useSelector(function(e){return{value:e.data[m],field:e.fields[m]}},shallowEqual),t=e.value,u=e.field,a=useFieldEvent(m),r=useDispatch(),e=React.useState(!1),e=slice._slicedToArray(e,2),n=e[0],o=e[1];React.useEffect(function(){n&&a(ON_UPDATE)},[a,t]),React.useEffect(function(){n||(a(ON_LOAD),o(!0))},[a,n]);var c=React.useCallback(function(e){r(c({name:m,value:e}))},[r]),i=React.useCallback(function(e){r(i({name:m,update:e}))},[r]),l=React.useCallback(function(e,t){r(l({name:m,error:e,message:t}))},[r]),s=React.useCallback(function(e){r(s({name:m,error:e}))},[r]),d=React.useCallback(function(e){if(u[e]&&"function"==typeof u[e]){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];u[e].apply(u,r)}a(e)},[u,a]),f=React.useCallback(function(e){c(e),d(ON_CHANGE)},[d,c]),p=React.useCallback(function(e){d(ON_BLUR,e)},[d]),R=React.useCallback(function(e){d(ON_BLUR,e)},[d]),e=React.useMemo(function(){return slice._objectSpread2(slice._objectSpread2({onChange:f,onBlur:p,onClick:R,updateField:i,setError:l,clearError:s,errors:u.errors,error:u.errors&&0<Object.keys(u.errors).length,errorMessage:u.errors&&Object.keys(u.errors).length?u.errors[Object.keys(u.errors)[0]]:null,type:u.type,label:u.label+(u.required?" *":"")},u.props),{},{name:m,value:t})},[s,u.errors,u.label,u.props,u.type,p,f,R,l,i,t]);return null!=u&&u.hidden?null:React__default.default.createElement("div",{className:"form-frame-field",id:"field-"+m},React__default.default.createElement(React.Suspense,{fallback:React__default.default.createElement("p",null,"Loading...")},v?React__default.default.createElement("component",e):React__default.default.createElement("p",null,"component missing for field ",m)))}};Field.proptypes={name:slice.propTypes.string.isRequired,component:slice.propTypes.element},exports.default=Field;
//# sourceMappingURL=field.js.map
